{% extends "root.html" %}
{% block title %}
    BHMS Report of New Tallah ROB (Hemanta Setu) &nbsp; Summery Report &nbsp; &nbsp; From {{ start_date }} to {{ end_date }}
{% endblock %}
{% block styles %}<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>{% endblock %}
{% block content %}
<div class="container">
    <!-- Other HTML content -->
    {% for group_data in strain_charts_data %}
        <script>
    // Get data from the Jinja context
    let strainData{{ loop.index }} = JSON.parse('{{ group_data.data | tojson | safe }}');
    let labels{{ loop.index }} = {{ group_data['labels'] | safe }}
    console.log('------- hi ------')
    console.log({{ group_data['labels'] | safe }})

    // Remove 'DateTime' key from the data
    // delete strainData{{loop.index}}['DateTime'];

    // Get column names for the accelerometer data
    // let strainColumns = Object.keys(data);

    // Create a separate Line chart for each accelerometer column
    strainData{{ loop.index }}.forEach(function (groupData, groupIndex) {
        // console.log(groupData)
        // console.log(groupData.column_name)
        // Create Chart.js Line chart
        const ctx = document.createElement('canvas');
        ctx.setAttribute('id', 'chart-{{ loop.index }}');
        ctx.setAttribute('width', '400');
        ctx.setAttribute('height', '200');
        document.body.appendChild(ctx);
        ctx.getContext('2d');

        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels{{ loop.index }},
                datasets: [
                    {
                        data: groupData.values,
                        label: groupData.column_name,
                        borderColor: "blue",
                        fill: false
                    }
                ]
            },

            options: {
                plugins: {
                    title: {
                        display: true,
                        text: "Chart - " + groupData.column_name,
                        color: 'navy',
                        position: 'bottom',
                        align: 'center',
                        font: {
                            weight: 'bold'
                        },
                        padding: 8,
                        fullSize: true,
                    }
                }
            }
        });
    });
        </script>
    {% endfor %}
</div>
{% endblock %}
